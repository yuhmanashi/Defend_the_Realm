(()=>{var e={417:(e,t,s)=>{const a=s(891),i=s(222),h=s(740),r=s(47),o=s(184),n=s(847),d=s(683),l=s(599),c=s(507),p=document.getElementById("game-canvas"),m=p.getContext("2d");p.width=800,p.height=600;const w=["background/forest","misc/play250x83","misc/scroll3","misc/exit","misc/endless"],g=[],u=["background/hud","towers/base/knightbase120","towers/base/archerbase120","towers/base/icewizardbase120","misc/speedbtn4"],x=[],f=["portal/50x105","portal/endgreen"],y=[],v=["background/forest","misc/exit","mobs/viking_lose1","mobs/viking_lose2","mobs/viking_lose3","mobs/viking_lose4","mobs/viking_lose5","mobs/viking_lose6","towers/base/archerwin","towers/base/knightwin","towers/base/wizardwin","mobs/viking_lose7"],b=[];let S=new h(2,50,300),I=new l(0,0),k=new d,T=new c,M=0,R=!1,E=!1,C=!1,P=1,G=new i(p,m),H=[],W=!0;G.canvas.addEventListener("click",(e=>{if(W=!0,G.x=e.x-G.offsetX,G.y=e.y-G.offsetY,R||(E||T.winGame?G.x>=273&&G.x<=525&&G.y>=397&&G.y<=473&&window.location.reload():G.x>=273&&G.x<=525&&G.y>=321&&G.y<=395?(R=!0,C=!0):G.x>=273&&G.x<=525&&G.y>=448&&G.y<=523&&(T.endlessMode(),R=!0,C=!0)),R){if(G.tower){if(G.tower.update(G.x,G.y),!H.includes(G.x)&&G.x>=120&&G.x<=700){for(let e=0;e<H.length;e++)G.checkRange(G.x,H[e],60)||(W=!1);W&&G.tower.checkMoney(T)&&(H.push(G.x),G.y<=S.y+10&&G.y>=S.upperY&&(G.tower.update(G.x,S.y-35),G.tower.currentTowers().push(G.tower),G.tower.payCost(T),G.tower.manageTowers()))}G.tower=null}G.x>=674&&G.x<=740&&G.y>=69&&G.y<=106&&(8===P?P=1:P*=2),G.x>=44&&G.x<=93&&G.y>=490&&G.y<=585?G.tower=new r(G.x,G.y):G.x>=124&&G.x<=172&&G.y>=490&&G.y<=585?G.tower=new n(G.x,G.y):G.x>=205&&G.x<=250&&G.y>=490&&G.y<=585&&(G.tower=new o(G.x,G.y))}})),e.exports=class{constructor(){this.animationOn=!1,this.gameSpeed=1,this.updateGameSpeed=this.updateGameSpeed.bind(this)}drawBackground(){m.drawImage(g[0],0,0,p.width,p.height)}preloadBackgrounds(e,t,s){a.preloadImages(e,t,s)}loadBackgrounds(){this.preloadBackgrounds(w,g,this.drawBackground)}renderHUD(){m.drawImage(x[0],0,440),m.drawImage(x[1],0,470),m.drawImage(x[2],80,470),m.drawImage(x[3],160,470),m.drawImage(x[4],700,65),m.fillStyle="black",m.font="20px Supermercado One, cursive",m.fillText("Knight",35,479),m.fillText("Archer",115,479),m.fillText("Wizard",195,479)}preloadHUD(e,t,s){a.preloadImages(e,t,s)}loadHUD(){this.preloadHUD(u,x,this.renderHUD)}renderPortals(){let e=S.x-20,t=S.x+673,s=S.y-95;m.drawImage(y[0],e,s),m.drawImage(y[1],t,s)}preloadPortals(e,t,s){a.preloadImages(e,t,s)}loadPortals(){this.preloadPortals(f,y,this.renderPortals)}renderGameOver(){m.clearRect(0,0,0,0),m.drawImage(g[0],0,0,p.width,p.height),m.drawImage(g[3],p.width/3+10,p.height/2+100),m.fillStyle="#ed5c5c",m.font="100px Syne Tactile, cursive",m.fillText("Game Over",p.width/3-100,p.height/3+50),T.endless()&&(m.fillStyle="white",m.font="50px Architects Daughter, cursive",m.fillText(`Your Score: ${T.playerScore()}`,210,140),m.fillText(`Furthest Wave: ${T.waveCount()}`,200,80))}loadGameOver(){this.preloadBackgrounds(w,g,this.renderGameOver)}renderWin(){m.clearRect(0,0,0,0),m.drawImage(b[0],0,0,p.width,p.height),m.drawImage(b[1],p.width/3+10,p.height/2+100),m.drawImage(b[2],100,100),m.drawImage(b[3],50,200),m.drawImage(b[4],160,260),m.drawImage(b[5],550,130),m.drawImage(b[6],200,100),m.drawImage(b[7],500,250),m.drawImage(b[11],530,90),m.drawImage(b[8],330,250),m.drawImage(b[9],240,270),m.drawImage(b[10],400,260),m.fillStyle="#d9b327",m.font="100px Syne Tactile, cursive",m.fillText("Victory!",p.width/3-20,p.height/3+60),m.font="40px Syne Tactile, cursive",m.fillText("More to come soon...",p.width/3-10,p.height/3+330)}preloadWin(e,t,s){a.preloadImages(e,t,s)}loadWin(){this.preloadWin(v,b,this.renderWin)}renderGameMode(){m.drawImage(g[0],0,0,p.width,p.height),m.drawImage(g[1],p.width/3+10,p.height/2+20),m.drawImage(g[2],205,p.height/5-70),m.drawImage(g[4],p.width/3+10,p.height/2+150),m.fillStyle="black",m.font="28px Syne Tactile, cursive",m.fillText("Choose your path.",295,120),m.fillText("Top for classic.",310,160),m.fillText("Bottom for endless.",295,200),m.fillStyle="#34ebb4",m.fillText("Classic",360,310),m.fillStyle="#e07b9b",m.fillText("Endless",360,440)}loadGameMode(){this.preloadBackgrounds(w,g,this.renderGameMode)}updateGameSpeed(e){e!==this.gameSpeed&&(this.gameSpeed=e)}animate(){this.updateGameSpeed(P),G.offsetRecalc(),T.winGame?(R=!1,G.x=0,this.loadWin()):R||(E?(C=!1,this.loadGameOver()):C||this.loadGameMode()),R&&(m.clearRect(0,0,0,0),this.loadBackgrounds(),S.preloadPlatforms(S.draw.bind(S)),this.loadPortals(),this.loadHUD(),T.draw(this.gameSpeed),T.hp<1&&(R=!1,E=!0,G.x=0),T.hp>0&&(I.manageTowers(k.currentMobs(),M,this.gameSpeed),k.manageMobs(T,I.currentAttacks(),M,this.gameSpeed)),M++),requestAnimationFrame(this.animate.bind(this))}}},683:(e,t,s)=>{const a=s(929),i=s(301),h=s(866),r=(document.getElementById("game-canvas").getContext("2d"),[]);let o=1;e.exports=class{constructor(){this.hp=0}addEventListener(e,t){this.canvas.addEventListener(e,t)}createMob(e,t){let s=Math.floor(3*Math.random());return 0===s?new a(e,t):1===s?new i(e,t):new h(e,t)}checkSpeed(e){r.every((e=>{e.speed,e.baseSpeed}))}changeSpeed(e){if(!this.checkSpeed(e))for(let t=0;t<r.length;t++)r[t].updateSpeed(e)}manageMobs(e,t,s,a){o=a,e.waveOver&&(r.splice(0,r.length),e.winGame?e.waveOver=!0:e.waveOver=!1);let i=this.createMob(e.waveCount());e.waveCount()>1&&i.waveScalar(),this.changeSpeed(o),Math.floor(s*a)%Math.floor(i.spawnRate)==0&&r.length<e.mobsCount&&r.push(i),Object.keys(t).forEach((e=>{let s=t[e].reduce(((e,t)=>e+t));r[e].loseHP(s),delete t[e]}));for(let t=0;t<r.length;t++)r[t].update(t),r[t].preload(r[t].draw.bind(r[t])),r[t].x>=670?(e.loseHP(r[t].damage),r.splice(t,1),t--):r[t].hp<1&&(e.endless()&&e.addScore(r[t].maxHP),e.getMoney(r[t].type+1+e.waveCount()),e.addMob(),r.splice(t,1),t--)}currentMobs(){return r}}},929:(e,t,s)=>{const a=s(364);e.exports=class extends a{constructor(e){super(e),this.type=0,this.hp=6,this.speed=.2,this.baseSpeed=.2,this.damage=1,this.baseSpawnRate=200,this.spawnRate=200}waveScalar(){this.hp=Math.floor(this.hp+this.wave-1),this.baseSpeed=this.baseSpeed+.01*this.wave,this.speed=this.baseSpeed,this.damage=Math.floor((this.damage+this.wave)/2),this.baseSpawnRate=this.baseSpawnRate-10*this.wave,this.spawnRate=this.baseSpawnRate,this.maxHP=this.hp}}},301:(e,t,s)=>{const a=s(364);e.exports=class extends a{constructor(e){super(e),this.y=220,this.type=1,this.hp=6,this.speed=.1,this.baseSpeed=.1,this.damage=2,this.baseSpawnRate=400,this.spawnRate=400}waveScalar(){this.hp=Math.floor(this.hp+this.wave-1),this.baseSpeed=this.baseSpeed+.01*this.wave,this.speed=this.baseSpeed,this.damage=Math.floor((this.damage+this.wave)/2)+1,this.baseSpawnRate=this.baseSpawnRate-15*this.wave,this.spawnRate=this.baseSpawnRate,this.maxHP=this.hp}}},866:(e,t,s)=>{const a=s(364);e.exports=class extends a{constructor(e){super(e),this.y=220,this.type=2,this.hp=12,this.speed=.1,this.baseSpeed=.1,this.damage=1,this.baseSpawnRate=400,this.spawnRate=400}waveScalar(){this.hp=Math.floor(this.hp+1.5*this.wave),this.baseSpeed=this.baseSpeed+.01*this.wave,this.speed=this.baseSpeed,this.damage=Math.floor((this.damage+this.wave)/2),this.baseSpawnRate=this.baseSpawnRate-15*this.wave,this.spawnRate=this.baseSpawnRate,this.maxHP=this.hp}}},222:e=>{e.exports=class{constructor(e,t){this.canvas=e,this.context=t,this.x=e.width/2,this.y=e.height/2,this.tower=null,this.offsetX=0,this.offsetY=0}addEventListener(e,t){this.canvas.addEventListener(e,t)}checkRange(e,t,s){return e<=t-s||e>=t+s}offsetRecalc(){const e=this.canvas.getBoundingClientRect();this.offsetX=e.left,this.offsetY=e.top}}},740:(e,t,s)=>{const a=s(891),i=document.getElementById("game-canvas").getContext("2d"),h=["platforms/224x32","platforms/384x32","platforms/704x32"],r=[];e.exports=class{constructor(e,t,s){this.type=e,this.height=32,this.x=t,this.y=s,this.upperY=this.y-150}preloadPlatforms(e){a.preloadImages(h,r,e)}draw(){i.drawImage(r[this.type],this.x,this.y)}}},507:(e,t,s)=>{s(891);const a=document.getElementById("game-canvas").getContext("2d");e.exports=class{constructor(){this.hp=20,this.maxHP=this.hp,this.money=200,this.wave=1,this.maxWave=5,this.mobsCount=10,this.mobsDeath=0,this.waveOver=!1,this.winGame=!1,this.score=0,this.mode=0}draw(e){a.fillStyle="white",a.font="50px Architects Daughter, cursive",a.fillText(`Wave: ${this.wave}/${this.maxWave}`,20,50),a.fillText(`Enemies: ${this.mobsDeath}/${this.mobsCount}`,450,50),a.fillText(`Speed: ${e}x`,450,100),1===this.mode&&a.fillText(`Score: ${this.score}`,20,110),a.fillStyle="black",a.fillText(`HP: ${this.hp}/${this.maxHP}`,525,515),a.fillText(`$: ${this.money}`,525,565)}loseHP(e){this.hp-=e}getMoney(e){this.money+=e}addWave(){this.wave+=1}waveCount(){return this.wave}addMob(){this.mobsDeath+=1,this.mobsDeath>=this.mobsCount&&(this.wave===this.maxWave?this.winGame=!0:(this.mobsDeath=0,this.mobsCount=Math.floor(1.5*this.mobsCount),this.wave+=1,this.waveOver=!0))}checkWin(){this.wave===this.maxWave&&(this.winGame=!0)}endlessMode(){this.mode=1,this.maxWave=99}endless(){return 1===this.mode}addScore(e){this.score+=e}playerScore(){return this.score}checkMoney(e){return this.money>0&&this.money-e>=0}}},599:(e,t,s)=>{const a=s(891),i=document.getElementById("game-canvas"),h=i.getContext("2d"),r=["towers/base/knightbase120","towers/base/archerbase120","towers/base/icewizardbase120"],o=[],n=[],d={};e.exports=class{constructor(e,t){this.type=null,this.x=e,this.y=t,this.width=30,this.height=40,this.radius=50,this.frame=0,this.range=0,this.damage=0,this.speed=0}update(e,t){this.x!=e&&(this.x=e-2*this.width),this.y!=t&&(this.y=t-2*this.height)}updateFrame(e){this.frame=e}preloadTower(e){a.preloadImages(r,o,e)}draw(){h.drawImage(o[this.type],this.x,this.y)}drawRect(){h.fillStyle=this.color,h.fillRect(this.x,this.y,this.width,this.height)}addEventListener(e,t){i.addEventListener(e,t)}compareX(e,t){return e>t?1:-1}sortedTowers(){return n.sort((function(e,t){return e.x-t.x}))}manageTowers(e,t,s){this.changeSpeed(s);const a=this.sortedTowers();for(let s=0;s<a.length;s++){if(Math.floor(t)%Math.floor(a[s].speed)==0){let t=a[s].findEnemies(e);t instanceof Array&&a[s].addAttack(t)}a[s].updateFrame(t),a[s].preloadTower(a[s].draw.bind(a[s]))}}addAttack(e){e.forEach((e=>{d[e]||(d[e]=[]),d[e].push(this.damage)}))}currentTowers(){return n}currentAttacks(){return d}checkMoney(e){return e.money>0&&e.money-this.cost>=0}payCost(e){e.money-=this.cost}checkSpeed(e){n.every((e=>{e.speed,e.baseSpeed}))}changeSpeed(e){if(!this.checkSpeed(e))for(let t=0;t<n.length;t++)n[t].updateSpeed(e)}updateSpeed(e){this.speed=this.baseSpeed/e}}},847:(e,t,s)=>{const a=s(599);e.exports=class extends a{constructor(e,t){super(e,t),this.type=1,this.color="green",this.range=250,this.damage=2,this.speed=200,this.baseSpeed=200,this.cost=50}findEnemies(e){let t=[];if(1!==t.length)for(let s=0;s<e.length&&t.length<1;s++){let a=e[s].currentInfo()[0],i=e[s].currentInfo()[1];i>this.x-this.range&&i<=this.x+70&&t.push(a)}return t.length?t:0}}},47:(e,t,s)=>{const a=s(599);e.exports=class extends a{constructor(e,t){super(e,t),this.height=39,this.type=0,this.color="orange",this.range=-10,this.damage=2,this.speed=300,this.baseSpeed=300,this.cost=50}findEnemies(e){let t=[];for(let s=0;s<e.length;s++){let a=e[s].currentInfo()[0],i=e[s].currentInfo()[1];i>this.x-this.range&&i<=this.x+120&&t.push(a)}return t.length?t:0}}},184:(e,t,s)=>{const a=s(599);e.exports=class extends a{constructor(e,t){super(e,t),this.type=2,this.color="blue",this.range=300,this.damage=3,this.speed=1e3,this.baseSpeed=1e3,this.cost=100}findEnemies(e){let t=[];for(let s=0;s<e.length;s++){let a=e[s].currentInfo()[0],i=e[s].currentInfo()[1];i>this.x-this.range&&i<=this.x+70&&t.push(a)}return t.length?t:0}}},891:e=>{const t={preloadImages(e,t,s){let a=0;!e instanceof Array&&(e=e());let i=e.length;e.forEach((e=>{!function(e,t,s){const a=new Image;a.onload=s,a.src=`./assets/images/${e}.png`,t.push(a)}(e,t,(function(){a++,a===i&&s()}))}))},reset(e){e.splice(0,e.length)}};e.exports=t},364:(e,t,s)=>{const a=s(891),i=document.getElementById("game-canvas").getContext("2d"),h=["mobs/viking1_90","mobs/viking2_90","mobs/viking3_90"],r=[],o=[];e.exports=class{constructor(e){this.wave=e,this.id=0,this.type=0,this.x=30,this.y=225,this.spriteWidth=90,this.spriteHeight=90,this.maxFrame=10,this.frame=0,this.hp=5,this.maxHP=this.hp,this.posX=this.x,this.speed=.2,this.baseSpeed=.2,this.damage=1,this.spawnrate=200}update(e){this.x<=670&&(this.x+=this.speed,this.posX=this.x+55),this.id!==e&&(this.id=e)}preload(e){a.preloadImages(h,r,e)}draw(){i.drawImage(r[this.type],this.x,this.y),i.fillStyle="#f2e277",i.font="20px Syne Tactile, cursive",i.fillText(Math.floor(this.hp),this.x+45,this.y)}addEventListener(e,t){this.canvas.addEventListener(e,t)}currentVikings(){return o}currentInfo(){return[this.id,this.posX]}loseHP(e){this.hp-=e}currentImages(){return r}currentURLS(){return h}updateSpeed(e){this.speed=this.baseSpeed*e,this.spawnRate=this.baseSpawnRate/e}}}},t={};(new(function s(a){var i=t[a];if(void 0!==i)return i.exports;var h=t[a]={exports:{}};return e[a](h,h.exports,s),h.exports}(417))).animate()})();