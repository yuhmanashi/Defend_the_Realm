(()=>{var e={417:(e,t,s)=>{const i=s(891),a=s(222),h=s(740),r=s(47),n=s(184),o=s(847),d=s(683),l=s(599),c=s(507),m=document.getElementById("game-canvas"),p=m.getContext("2d");m.width=800,m.height=600;const g=["background/forest","misc/play250x83","misc/scroll3","misc/exit","misc/endless"],w=[],u=["background/hud","towers/base/knightbase120","towers/base/archerbase120","towers/base/icewizardbase120","misc/speedbtn4"],x=[],f=["portal/50x105","portal/endgreen"],v=[],b=["background/forest","misc/exit","mobs/viking_lose1","mobs/viking_lose2","mobs/viking_lose3","mobs/viking_lose4","mobs/viking_lose5","mobs/viking_lose6","towers/base/archerwin","towers/base/knightwin","towers/base/wizardwin","mobs/viking_lose7"],y=[];let S=new h(2,50,300),k=new l(0,0),I=new d,T=new c,M=0,R=!1,E=!1,C=!1,P=1,G=new a(m,p),H=[],B=!0;G.canvas.addEventListener("click",(e=>{if(B=!0,G.x=e.x-G.offsetX,G.y=e.y-G.offsetY,R||(E||T.winGame?G.x>=273&&G.x<=525&&G.y>=397&&G.y<=473&&window.location.reload():G.x>=273&&G.x<=525&&G.y>=321&&G.y<=395?(R=!0,C=!0):G.x>=273&&G.x<=525&&G.y>=448&&G.y<=523&&(T.endlessMode(),R=!0,C=!0)),R){if(G.tower){if(G.tower.update(G.x,G.y),!H.includes(G.x)&&G.x>=120&&G.x<=700){for(let e=0;e<H.length;e++)G.checkRange(G.x,H[e],60)||(B=!1);B&&G.tower.checkMoney(T)&&(H.push(G.x),G.y<=S.y+10&&G.y>=S.upperY&&(G.tower.update(G.x,S.y-35),G.tower.currentTowers().push(G.tower),G.tower.payCost(T),G.tower.manageTowers()))}G.tower=null}G.x>=674&&G.x<=740&&G.y>=69&&G.y<=106&&(8===P?P=1:P*=2),G.x>=44&&G.x<=93&&G.y>=490&&G.y<=585?G.tower=new r(G.x,G.y):G.x>=124&&G.x<=172&&G.y>=490&&G.y<=585?G.tower=new o(G.x,G.y):G.x>=205&&G.x<=250&&G.y>=490&&G.y<=585&&(G.tower=new n(G.x,G.y))}})),e.exports=class{constructor(){this.animationOn=!1,this.gameSpeed=1,this.updateGameSpeed=this.updateGameSpeed.bind(this)}drawBackground(){p.drawImage(w[0],0,0,m.width,m.height)}preloadBackgrounds(e,t,s){i.preloadImages(e,t,s)}loadBackgrounds(){this.preloadBackgrounds(g,w,this.drawBackground)}renderHUD(){p.drawImage(x[0],0,440),p.drawImage(x[1],0,470),p.drawImage(x[2],80,470),p.drawImage(x[3],160,470),p.drawImage(x[4],700,65),p.fillStyle="black",p.font="20px Supermercado One, cursive",p.fillText("Knight",35,479),p.fillText("Archer",115,479),p.fillText("Wizard",195,479)}preloadHUD(e,t,s){i.preloadImages(e,t,s)}loadHUD(){this.preloadHUD(u,x,this.renderHUD)}renderPortals(){let e=S.x-20,t=S.x+673,s=S.y-95;p.drawImage(v[0],e,s),p.drawImage(v[1],t,s)}preloadPortals(e,t,s){i.preloadImages(e,t,s)}loadPortals(){this.preloadPortals(f,v,this.renderPortals)}renderGameOver(){p.clearRect(0,0,0,0),p.drawImage(w[0],0,0,m.width,m.height),p.drawImage(w[3],m.width/3+10,m.height/2+100),p.fillStyle="#ed5c5c",p.font="100px Syne Tactile, cursive",p.fillText("Game Over",m.width/3-100,m.height/3+50),T.endless()&&(p.fillStyle="white",p.font="50px Architects Daughter, cursive",p.fillText(`Your Score: ${T.playerScore()}`,210,140),p.fillText(`Furthest Wave: ${T.waveCount()}`,200,80))}loadGameOver(){this.preloadBackgrounds(g,w,this.renderGameOver)}renderWin(){p.clearRect(0,0,0,0),p.drawImage(y[0],0,0,m.width,m.height),p.drawImage(y[1],m.width/3+10,m.height/2+100),p.drawImage(y[2],100,100),p.drawImage(y[3],50,200),p.drawImage(y[4],160,260),p.drawImage(y[5],550,130),p.drawImage(y[6],200,100),p.drawImage(y[7],500,250),p.drawImage(y[11],530,90),p.drawImage(y[8],330,250),p.drawImage(y[9],240,270),p.drawImage(y[10],400,260),p.fillStyle="#d9b327",p.font="100px Syne Tactile, cursive",p.fillText("Victory!",m.width/3-20,m.height/3+60),p.font="40px Syne Tactile, cursive",p.fillText("More to come soon...",m.width/3-10,m.height/3+330)}preloadWin(e,t,s){i.preloadImages(e,t,s)}loadWin(){this.preloadWin(b,y,this.renderWin)}renderGameMode(){p.drawImage(w[0],0,0,m.width,m.height),p.drawImage(w[1],m.width/3+10,m.height/2+20),p.drawImage(w[2],205,m.height/5-70),p.drawImage(w[4],m.width/3+10,m.height/2+150),p.fillStyle="black",p.font="28px Syne Tactile, cursive",p.fillText("Choose your path.",295,120),p.fillText("Top for classic.",310,160),p.fillText("Bottom for endless.",295,200),p.fillStyle="#34ebb4",p.fillText("Classic",360,310),p.fillStyle="#e07b9b",p.fillText("Endless",360,440)}loadGameMode(){this.preloadBackgrounds(g,w,this.renderGameMode)}updateGameSpeed(e){e!==this.gameSpeed&&(this.gameSpeed=e)}animate(){this.updateGameSpeed(P),G.offsetRecalc(),T.winGame?(R=!1,G.x=0,this.loadWin()):R||(E?(C=!1,this.loadGameOver()):C||this.loadGameMode()),R&&(p.clearRect(0,0,0,0),this.loadBackgrounds(),S.preloadPlatforms(S.draw.bind(S)),this.loadPortals(),this.loadHUD(),T.draw(this.gameSpeed),T.hp<1&&(R=!1,E=!0,G.x=0),T.hp>0&&(k.manageTowers(I.currentMobs(),M,this.gameSpeed),I.manageMobs(T,k.currentAttacks(),M,this.gameSpeed)),M++),requestAnimationFrame(this.animate.bind(this))}}},683:(e,t,s)=>{const i=s(201),a=s(571),h=s(947),r=(document.getElementById("game-canvas").getContext("2d"),[]);let n=1;e.exports=class{constructor(){this.hp=0}addEventListener(e,t){this.canvas.addEventListener(e,t)}createMob(e,t){let s=Math.floor(3*Math.random());return 0===s?new i(e,t):1===s?new a(e,t):new h(e,t)}checkSpeed(e){r.every((e=>{e.speed,e.baseSpeed}))}changeSpeed(e){if(!this.checkSpeed(e))for(let t=0;t<r.length;t++)r[t].updateSpeed(e)}manageMobs(e,t,s,i){n=i,e.waveOver&&(r.splice(0,r.length),e.winGame?e.waveOver=!0:e.waveOver=!1);let a=this.createMob(e.waveCount());e.waveCount()>1&&a.waveScalar(),this.changeSpeed(n),Math.floor(s*i)%Math.floor(a.spawnRate)==0&&r.length<e.mobsCount&&r.push(a),Object.keys(t).forEach((e=>{let s=t[e].reduce(((e,t)=>e+t));r[e].loseHP(s),delete t[e]}));for(let t=0;t<r.length;t++)r[t].update(t,s),r[t].preload(r[t].draw.bind(r[t])),r[t].x>=670?(e.loseHP(r[t].damage),r.splice(t,1),t--):r[t].hp<1&&(e.endless()&&e.addScore(r[t].maxHP),e.getMoney(r[t].type+1+e.waveCount()),e.addMob(),r.splice(t,1),t--)}currentMobs(){return r}}},201:(e,t,s)=>{const i=s(716),a=s(891),h=document.getElementById("game-canvas").getContext("2d"),r=["mobs/viking1/0","mobs/viking1/1","mobs/viking1/2","mobs/viking1/3","mobs/viking1/4","mobs/viking1/5","mobs/viking1/6","mobs/viking1/7","mobs/viking1/8","mobs/viking1/9"],n=[];e.exports=class extends i{constructor(e){super(e),this.type=0,this.hp=6,this.y=200,this.speed=.2,this.baseSpeed=.2,this.damage=1,this.baseSpawnRate=1e3,this.spawnRate=1e3,this.run=r,this.animation=this.run,this.frame=0}waveScalar(){this.hp=Math.floor(this.hp+this.wave-1),this.baseSpeed=this.baseSpeed+.01*this.wave,this.speed=this.baseSpeed,this.damage=Math.floor((this.damage+this.wave)/2),this.baseSpawnRate=this.baseSpawnRate-10*this.wave,this.spawnRate=this.baseSpawnRate,this.maxHP=this.hp}preload(e){a.preloadImages(this.animation,n,e)}draw(){h.drawImage(n[this.frame],this.x,200,130,130),h.fillStyle="#f2e277",h.font="20px Syne Tactile, cursive",h.fillText(Math.floor(this.hp),this.x+70,this.y+20)}}},571:(e,t,s)=>{const i=s(716),a=s(891),h=document.getElementById("game-canvas").getContext("2d"),r=["mobs/viking2/run/0","mobs/viking2/run/1","mobs/viking2/run/2","mobs/viking2/run/3","mobs/viking2/run/4","mobs/viking2/run/5","mobs/viking2/run/6","mobs/viking2/run/7","mobs/viking2/run/8","mobs/viking2/run/9"],n=[];e.exports=class extends i{constructor(e){super(e),this.y=200,this.type=1,this.hp=6,this.speed=.1,this.baseSpeed=.1,this.damage=2,this.baseSpawnRate=400,this.spawnRate=400,this.run=r,this.animation=this.run,this.frame=0}waveScalar(){this.hp=Math.floor(this.hp+this.wave-1),this.baseSpeed=this.baseSpeed+.01*this.wave,this.speed=this.baseSpeed,this.damage=Math.floor((this.damage+this.wave)/2)+1,this.baseSpawnRate=this.baseSpawnRate-15*this.wave,this.spawnRate=this.baseSpawnRate,this.maxHP=this.hp}preload(e){a.preloadImages(this.animation,n,e)}draw(){h.drawImage(n[this.frame],this.x,200,130,130),h.fillStyle="#f2e277",h.font="20px Syne Tactile, cursive",h.fillText(Math.floor(this.hp),this.x+70,this.y+20)}}},947:(e,t,s)=>{const i=s(716),a=s(891),h=document.getElementById("game-canvas").getContext("2d"),r=["mobs/viking3/run/0","mobs/viking3/run/1","mobs/viking3/run/2","mobs/viking3/run/3","mobs/viking3/run/4","mobs/viking3/run/5","mobs/viking3/run/6","mobs/viking3/run/7","mobs/viking3/run/8","mobs/viking3/run/9"],n=[];e.exports=class extends i{constructor(e){super(e),this.y=200,this.type=2,this.hp=12,this.speed=.1,this.baseSpeed=.1,this.damage=1,this.baseSpawnRate=400,this.spawnRate=400,this.run=r,this.animation=this.run,this.frame=0}waveScalar(){this.hp=Math.floor(this.hp+1.5*this.wave),this.baseSpeed=this.baseSpeed+.01*this.wave,this.speed=this.baseSpeed,this.damage=Math.floor((this.damage+this.wave)/2),this.baseSpawnRate=this.baseSpawnRate-15*this.wave,this.spawnRate=this.baseSpawnRate,this.maxHP=this.hp}preload(e){a.preloadImages(this.animation,n,e)}draw(){h.drawImage(n[this.frame],this.x,200,130,130),h.fillStyle="#f2e277",h.font="20px Syne Tactile, cursive",h.fillText(Math.floor(this.hp),this.x+70,this.y+20)}}},222:e=>{e.exports=class{constructor(e,t){this.canvas=e,this.context=t,this.x=e.width/2,this.y=e.height/2,this.tower=null,this.offsetX=0,this.offsetY=0}addEventListener(e,t){this.canvas.addEventListener(e,t)}checkRange(e,t,s){return e<=t-s||e>=t+s}offsetRecalc(){const e=this.canvas.getBoundingClientRect();this.offsetX=e.left,this.offsetY=e.top}}},740:(e,t,s)=>{const i=s(891),a=document.getElementById("game-canvas").getContext("2d"),h=["platforms/224x32","platforms/384x32","platforms/704x32"],r=[];e.exports=class{constructor(e,t,s){this.type=e,this.height=32,this.x=t,this.y=s,this.upperY=this.y-150}preloadPlatforms(e){i.preloadImages(h,r,e)}draw(){a.drawImage(r[this.type],this.x,this.y)}}},507:(e,t,s)=>{s(891);const i=document.getElementById("game-canvas").getContext("2d");e.exports=class{constructor(){this.hp=20,this.maxHP=this.hp,this.money=200,this.wave=1,this.maxWave=5,this.mobsCount=10,this.mobsDeath=0,this.waveOver=!1,this.winGame=!1,this.score=0,this.mode=0}draw(e){i.fillStyle="white",i.font="50px Architects Daughter, cursive",i.fillText(`Wave: ${this.wave}/${this.maxWave}`,20,50),i.fillText(`Enemies: ${this.mobsDeath}/${this.mobsCount}`,450,50),i.fillText(`Speed: ${e}x`,450,100),1===this.mode&&i.fillText(`Score: ${this.score}`,20,110),i.fillStyle="black",i.fillText(`HP: ${this.hp}/${this.maxHP}`,525,515),i.fillText(`$: ${this.money}`,525,565)}loseHP(e){this.hp-=e}getMoney(e){this.money+=e}addWave(){this.wave+=1}waveCount(){return this.wave}addMob(){this.mobsDeath+=1,this.mobsDeath>=this.mobsCount&&(this.wave===this.maxWave?this.winGame=!0:(this.mobsDeath=0,this.mobsCount=Math.floor(1.5*this.mobsCount),this.wave+=1,this.waveOver=!0))}checkWin(){this.wave===this.maxWave&&(this.winGame=!0)}endlessMode(){this.mode=1,this.maxWave=99}endless(){return 1===this.mode}addScore(e){this.score+=e}playerScore(){return this.score}checkMoney(e){return this.money>0&&this.money-e>=0}}},599:(e,t,s)=>{const i=s(891),a=document.getElementById("game-canvas"),h=a.getContext("2d"),r=["towers/base/knightbase120","towers/base/archerbase120","towers/base/icewizardbase120"],n=[],o=[],d={};e.exports=class{constructor(e,t){this.type=null,this.x=e,this.y=t,this.width=30,this.height=40,this.radius=50,this.frame=0,this.range=0,this.damage=0,this.speed=0}update(e,t){this.x!=e&&(this.x=e-2*this.width),this.y!=t&&(this.y=t-2*this.height)}updateFrame(e){this.frame=e}preloadTower(e){i.preloadImages(r,n,e)}draw(){h.drawImage(n[this.type],this.x,this.y)}drawRect(){h.fillStyle=this.color,h.fillRect(this.x,this.y,this.width,this.height)}addEventListener(e,t){a.addEventListener(e,t)}compareX(e,t){return e>t?1:-1}sortedTowers(){return o.sort((function(e,t){return e.x-t.x}))}manageTowers(e,t,s){this.changeSpeed(s);const i=this.sortedTowers();for(let s=0;s<i.length;s++){if(Math.floor(t)%Math.floor(i[s].speed)==0){let t=i[s].findEnemies(e);t instanceof Array&&i[s].addAttack(t)}i[s].updateFrame(t),i[s].preloadTower(i[s].draw.bind(i[s]))}}addAttack(e){e.forEach((e=>{d[e]||(d[e]=[]),d[e].push(this.damage)}))}currentTowers(){return o}currentAttacks(){return d}checkMoney(e){return e.money>0&&e.money-this.cost>=0}payCost(e){e.money-=this.cost}checkSpeed(e){o.every((e=>{e.speed,e.baseSpeed}))}changeSpeed(e){if(!this.checkSpeed(e))for(let t=0;t<o.length;t++)o[t].updateSpeed(e)}updateSpeed(e){this.speed=this.baseSpeed/e}}},847:(e,t,s)=>{const i=s(599);e.exports=class extends i{constructor(e,t){super(e,t),this.type=1,this.color="green",this.range=250,this.damage=2,this.speed=300,this.baseSpeed=300,this.cost=50}findEnemies(e){let t=[];if(1!==t.length)for(let s=0;s<e.length&&t.length<1;s++){let i=e[s].currentInfo()[0],a=e[s].currentInfo()[1];a>this.x-this.range&&a<=this.x+70&&t.push(i)}return t.length?t:0}}},47:(e,t,s)=>{const i=s(599);e.exports=class extends i{constructor(e,t){super(e,t),this.height=39,this.type=0,this.color="orange",this.range=-10,this.damage=2,this.speed=400,this.baseSpeed=400,this.cost=50}findEnemies(e){let t=[];for(let s=0;s<e.length;s++){let i=e[s].currentInfo()[0],a=e[s].currentInfo()[1];a>this.x-this.range&&a<=this.x+120&&t.push(i)}return t.length?t:0}}},184:(e,t,s)=>{const i=s(599);e.exports=class extends i{constructor(e,t){super(e,t),this.type=2,this.color="blue",this.range=300,this.damage=4,this.speed=1100,this.baseSpeed=1100,this.cost=100}findEnemies(e){let t=[];for(let s=0;s<e.length;s++){let i=e[s].currentInfo()[0],a=e[s].currentInfo()[1];a>this.x-this.range&&a<=this.x+70&&t.push(i)}return t.length?t:0}}},891:e=>{const t={preloadImages(e,t,s){let i=0;!e instanceof Array&&(e=e());let a=e.length;e.forEach((e=>{!function(e,t,s){const i=new Image;i.onload=s,i.src=`./assets/images/${e}.png`,t.push(i)}(e,t,(function(){i++,i===a&&s()}))}))},reset(e){e.splice(0,e.length)}};e.exports=t},716:e=>{const t=["mobs/viking1_90","mobs/viking2_90","mobs/viking3_90","mobs/v1_771x90sprite"],s=[],i=[];e.exports=class{constructor(e){this.wave=e,this.id=0,this.type=0,this.x=30,this.y=225,this.spriteWidth=90,this.spriteHeight=90,this.maxFrame=10,this.frame=0,this.hp=5,this.maxHP=this.hp,this.posX=this.x,this.speed=.2,this.baseSpeed=.2,this.damage=1,this.spawnrate=200,this.animation=[]}update(e,t){this.frame=Math.floor(t/3%10),this.x<=670&&(this.x+=this.speed,this.posX=this.x+55),this.id!==e&&(this.id=e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}currentVikings(){return i}currentInfo(){return[this.id,this.posX]}loseHP(e){this.hp-=e}currentImages(){return s}currentURLS(){return t}updateSpeed(e){this.speed=this.baseSpeed*e,this.spawnRate=this.baseSpawnRate/e}}}},t={};(new(function s(i){var a=t[i];if(void 0!==a)return a.exports;var h=t[i]={exports:{}};return e[i](h,h.exports,s),h.exports}(417))).animate()})();