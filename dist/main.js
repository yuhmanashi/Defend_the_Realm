(()=>{var e={417:(e,t,s)=>{const a=s(891),i=s(222),r=s(740),h=s(47),o=s(184),n=s(847),d=s(683),l=s(599),c=s(507),m=document.getElementById("game-canvas"),p=m.getContext("2d");m.width=800,m.height=600;const w=["background/forest","misc/play250x83","misc/scroll3","misc/exit","misc/endless"],g=[],u=["background/hud","towers/base/knightbase120","towers/base/archerbase120","towers/base/icewizardbase120"],x=[],y=["portal/50x105","portal/endgreen"],v=[],f=["background/forest","misc/exit","mobs/viking_lose1","mobs/viking_lose2","mobs/viking_lose3","mobs/viking_lose4","mobs/viking_lose5","mobs/viking_lose6","towers/base/archerwin","towers/base/knightwin","towers/base/wizardwin","mobs/viking_lose7"],b=[];let I=new r(2,50,300),k=new l(0,0),T=new d,M=new c,S=0,E=!1,C=!1,P=!1;const H=m.getBoundingClientRect();let W=new i(m,p),B=[],G=!0;W.canvas.addEventListener("click",(e=>{if(G=!0,W.x=e.x-H.left,W.y=e.y-H.top,E||(C||M.winGame?W.x>=273&&W.x<=525&&W.y>=397&&W.y<=473&&window.location.reload():W.x>=273&&W.x<=525&&W.y>=321&&W.y<=395?(E=!0,P=!0):W.x>=273&&W.x<=525&&W.y>=448&&W.y<=523&&(M.endlessMode(),E=!0,P=!0)),E){if(W.tower){if(W.tower.update(W.x,W.y),!B.includes(W.x)&&W.x>=120&&W.x<=700){for(let e=0;e<B.length;e++)W.checkRange(W.x,B[e],60)||(G=!1);G&&W.tower.checkMoney(M)&&(B.push(W.x),W.y<=I.y+10&&W.y>=I.upperY&&(W.tower.update(W.x,I.y-35),W.tower.currentTowers().push(W.tower),W.tower.payCost(M),W.tower.manageTowers()))}W.tower=null}W.x>=44&&W.x<=93&&W.y>=490&&W.y<=585?W.tower=new h(W.x,W.y):W.x>=124&&W.x<=172&&W.y>=490&&W.y<=585?W.tower=new n(W.x,W.y):W.x>=205&&W.x<=250&&W.y>=490&&W.y<=585&&(W.tower=new o(W.x,W.y))}})),e.exports=class{constructor(){this.animationOn=!1}drawBackground(){p.drawImage(g[0],0,0,m.width,m.height)}preloadBackgrounds(e,t,s){a.preloadImages(e,t,s)}loadBackgrounds(){this.preloadBackgrounds(w,g,this.drawBackground)}renderHUD(){p.drawImage(x[0],0,440),p.drawImage(x[1],0,470),p.drawImage(x[2],80,470),p.drawImage(x[3],160,470),p.fillStyle="black",p.font="20px Supermercado One, cursive",p.fillText("Knight",35,479),p.fillText("Archer",115,479),p.fillText("Wizard",195,479)}preloadHUD(e,t,s){a.preloadImages(e,t,s)}loadHUD(){this.preloadHUD(u,x,this.renderHUD)}renderPortals(){let e=I.x-20,t=I.x+673,s=I.y-95;p.drawImage(v[0],e,s),p.drawImage(v[1],t,s)}preloadPortals(e,t,s){a.preloadImages(e,t,s)}loadPortals(){this.preloadPortals(y,v,this.renderPortals)}renderGameOver(){p.clearRect(0,0,0,0),p.drawImage(g[0],0,0,m.width,m.height),p.drawImage(g[3],m.width/3+10,m.height/2+100),p.fillStyle="#ed5c5c",p.font="100px Syne Tactile, cursive",p.fillText("Game Over",m.width/3-100,m.height/3+50),M.endless()&&(p.fillStyle="white",p.font="50px Architects Daughter, cursive",p.fillText(`Your Score: ${M.playerScore()}`,210,140),p.fillText(`Furthest Wave: ${M.waveCount()}`,200,80))}loadGameOver(){this.preloadBackgrounds(w,g,this.renderGameOver)}renderWin(){p.clearRect(0,0,0,0),p.drawImage(b[0],0,0,m.width,m.height),p.drawImage(b[1],m.width/3+10,m.height/2+100),p.drawImage(b[2],100,100),p.drawImage(b[3],50,200),p.drawImage(b[4],160,260),p.drawImage(b[5],550,130),p.drawImage(b[6],200,100),p.drawImage(b[7],500,250),p.drawImage(b[11],530,90),p.drawImage(b[8],330,250),p.drawImage(b[9],240,270),p.drawImage(b[10],400,260),p.fillStyle="#d9b327",p.font="100px Syne Tactile, cursive",p.fillText("Victory!",m.width/3-20,m.height/3+60),p.font="40px Syne Tactile, cursive",p.fillText("More to come soon...",m.width/3-10,m.height/3+330)}preloadWin(e,t,s){a.preloadImages(e,t,s)}loadWin(){this.preloadWin(f,b,this.renderWin)}renderGameMode(){p.drawImage(g[0],0,0,m.width,m.height),p.drawImage(g[1],m.width/3+10,m.height/2+20),p.drawImage(g[2],205,m.height/5-70),p.drawImage(g[4],m.width/3+10,m.height/2+150),p.fillStyle="black",p.font="28px Syne Tactile, cursive",p.fillText("Choose your path.",295,120),p.fillText("Top for classic.",310,160),p.fillText("Bottom for endless.",295,200),p.fillStyle="#34ebb4",p.fillText("Classic",360,310),p.fillStyle="#e07b9b",p.fillText("Endless",360,440)}loadGameMode(){this.preloadBackgrounds(w,g,this.renderGameMode)}animate(){M.winGame?(E=!1,W.x=0,this.loadWin()):E||(C?(P=!1,this.loadGameOver()):P||this.loadGameMode()),E&&(p.clearRect(0,0,0,0),this.loadBackgrounds(),I.preloadPlatforms(I.draw.bind(I)),this.loadPortals(),this.loadHUD(),M.draw(),M.hp<1&&(E=!1,C=!0,W.x=0),M.hp>0&&(k.manageTowers(T.currentMobs(),S),T.manageMobs(M,k.currentAttacks(),S)),S++),requestAnimationFrame(this.animate.bind(this))}}},683:(e,t,s)=>{const a=s(929),i=s(301),r=s(866),h=(document.getElementById("game-canvas").getContext("2d"),[]);e.exports=class{constructor(){this.hp=0}addEventListener(e,t){this.canvas.addEventListener(e,t)}createMob(e){let t=Math.floor(3*Math.random());return 0===t?new a(e):1===t?new i(e):new r(e)}manageMobs(e,t,s){e.waveOver&&(h.splice(0,h.length),e.winGame?e.waveOver=!0:e.waveOver=!1);let a=this.createMob(e.waveCount());e.waveCount()>1&&a.waveScalar(),s%a.spawnrate==0&&h.length<e.mobsCount&&h.push(a),Object.keys(t).forEach((e=>{let s=t[e].reduce(((e,t)=>e+t));h[e].loseHP(s),delete t[e]}));for(let t=0;t<h.length;t++)h[t].update(t),h[t].preload(h[t].draw.bind(h[t])),h[t].x>=670?(e.loseHP(h[t].damage),h.splice(t,1),t--):h[t].hp<1&&(e.endless()&&e.addScore(h[t].maxHP),e.getMoney(h[t].type+1+e.waveCount()),e.addMob(),h.splice(t,1),t--)}currentMobs(){return h}}},929:(e,t,s)=>{const a=s(364);e.exports=class extends a{constructor(e){super(e),this.type=0,this.hp=5,this.speed=.2,this.damage=1,this.spawnrate=200}waveScalar(){this.hp=Math.floor(this.hp+this.wave-1),this.speed=this.speed+.01*this.wave,this.damage=Math.floor((this.damage+this.wave)/2),this.spawnrate=this.spawnrate-10*this.wave,this.maxHP=this.hp}}},301:(e,t,s)=>{const a=s(364);e.exports=class extends a{constructor(e){super(e),this.y=220,this.type=1,this.hp=5,this.speed=.1,this.damage=2,this.spawnrate=400}waveScalar(){this.hp=Math.floor(this.hp+this.wave-1),this.speed=this.speed+.01*this.wave,this.damage=Math.floor((this.damage+this.wave)/2)+1,this.spawnrate=this.spawnrate-15*this.wave,this.maxHP=this.hp}}},866:(e,t,s)=>{const a=s(364);e.exports=class extends a{constructor(e){super(e),this.y=220,this.type=2,this.hp=10,this.speed=.1,this.damage=1,this.spawnrate=400}waveScalar(){this.hp=Math.floor(this.hp+1.5*this.wave),this.speed=this.speed+.01*this.wave,this.damage=Math.floor((this.damage+this.wave)/2),this.spawnrate=this.spawnrate-15*this.wave,this.maxHP=this.hp}}},222:e=>{e.exports=class{constructor(e,t){this.canvas=e,this.context=t,this.x=e.width/2,this.y=e.height/2,this.tower=null}addEventListener(e,t){this.canvas.addEventListener(e,t)}checkRange(e,t,s){return e<=t-s||e>=t+s}}},740:(e,t,s)=>{const a=s(891),i=document.getElementById("game-canvas").getContext("2d"),r=["platforms/224x32","platforms/384x32","platforms/704x32"],h=[];e.exports=class{constructor(e,t,s){this.type=e,this.height=32,this.x=t,this.y=s,this.upperY=this.y-150}preloadPlatforms(e){a.preloadImages(r,h,e)}draw(){i.drawImage(h[this.type],this.x,this.y)}}},507:(e,t,s)=>{s(891);const a=document.getElementById("game-canvas").getContext("2d");e.exports=class{constructor(){this.hp=20,this.maxHP=this.hp,this.money=200,this.wave=1,this.maxWave=5,this.mobsCount=10,this.mobsDeath=0,this.waveOver=!1,this.winGame=!1,this.score=0,this.mode=0}draw(){a.fillStyle="white",a.font="50px Architects Daughter, cursive",a.fillText(`Wave: ${this.wave}/${this.maxWave}`,20,50),a.fillText(`Enemies: ${this.mobsDeath}/${this.mobsCount}`,450,50),1===this.mode&&a.fillText(`Score: ${this.score}`,20,110),a.fillStyle="black",a.fillText(`HP: ${this.hp}/${this.maxHP}`,525,515),a.fillText(`$: ${this.money}`,525,565)}loseHP(e){this.hp-=e}getMoney(e){this.money+=e}addWave(){this.wave+=1}waveCount(){return this.wave}addMob(){this.mobsDeath+=1,this.mobsDeath>=this.mobsCount&&(this.wave===this.maxWave?this.winGame=!0:(this.mobsDeath=0,this.mobsCount=2*this.mobsCount,this.wave+=1,this.waveOver=!0))}checkWin(){this.wave===this.maxWave&&(this.winGame=!0)}endlessMode(){this.mode=1,this.maxWave=99}endless(){return 1===this.mode}addScore(e){this.score+=e}playerScore(){return this.score}checkMoney(e){return this.money>0&&this.money-e>=0}}},599:(e,t,s)=>{const a=s(891),i=document.getElementById("game-canvas"),r=i.getContext("2d"),h=["towers/base/knightbase120","towers/base/archerbase120","towers/base/icewizardbase120"],o=[],n=[],d={};e.exports=class{constructor(e,t){this.type=null,this.x=e,this.y=t,this.width=30,this.height=40,this.radius=50,this.frame=0,this.range=0,this.damage=0,this.speed=0}update(e,t){this.x!=e&&(this.x=e-2*this.width),this.y!=t&&(this.y=t-2*this.height)}updateFrame(e){this.frame=e}preloadTower(e){a.preloadImages(h,o,e)}draw(){r.drawImage(o[this.type],this.x,this.y)}drawRect(){r.fillStyle=this.color,r.fillRect(this.x,this.y,this.width,this.height)}addEventListener(e,t){i.addEventListener(e,t)}compareX(e,t){return e>t?1:-1}sortedTowers(){return n.sort((function(e,t){return e.x-t.x}))}manageTowers(e,t){const s=this.sortedTowers();for(let a=0;a<s.length;a++){if(t%s[a].speed==0){let t=s[a].findEnemies(e);t instanceof Array&&s[a].addAttack(t)}s[a].updateFrame(t),s[a].preloadTower(s[a].draw.bind(s[a]))}}addAttack(e){e.forEach((e=>{d[e]||(d[e]=[]),d[e].push(this.damage)}))}currentTowers(){return n}currentAttacks(){return d}checkMoney(e){return e.money>0&&e.money-this.cost>=0}payCost(e){e.money-=this.cost}}},847:(e,t,s)=>{const a=s(599);e.exports=class extends a{constructor(e,t){super(e,t),this.type=1,this.color="green",this.range=250,this.damage=1,this.speed=200,this.cost=50}findEnemies(e){let t=[];if(1!==t.length)for(let s=0;s<e.length&&t.length<1;s++){let a=e[s].currentInfo()[0],i=e[s].currentInfo()[1];i>this.x-this.range&&i<=this.x+70&&t.push(a)}return t.length?t:0}}},47:(e,t,s)=>{const a=s(599);e.exports=class extends a{constructor(e,t){super(e,t),this.height=39,this.type=0,this.color="orange",this.range=-10,this.damage=1,this.speed=300,this.cost=50}findEnemies(e){let t=[];for(let s=0;s<e.length;s++){let a=e[s].currentInfo()[0],i=e[s].currentInfo()[1];i>this.x-this.range&&i<=this.x+120&&t.push(a)}return t.length?t:0}}},184:(e,t,s)=>{const a=s(599);e.exports=class extends a{constructor(e,t){super(e,t),this.type=2,this.color="blue",this.range=300,this.damage=2,this.speed=1e3,this.cost=100}findEnemies(e){let t=[];for(let s=0;s<e.length;s++){let a=e[s].currentInfo()[0],i=e[s].currentInfo()[1];i>this.x-this.range&&i<=this.x+70&&t.push(a)}return t.length?t:0}}},891:e=>{const t={preloadImages(e,t,s){let a=0;!e instanceof Array&&(e=e());let i=e.length;e.forEach((e=>{!function(e,t,s){const a=new Image;a.onload=s,a.src=`./assets/images/${e}.png`,t.push(a)}(e,t,(function(){a++,a===i&&s()}))}))},reset(e){e.splice(0,e.length)}};e.exports=t},364:(e,t,s)=>{const a=s(891),i=document.getElementById("game-canvas").getContext("2d"),r=["mobs/viking1_90","mobs/viking2_90","mobs/viking3_90"],h=[],o=[];e.exports=class{constructor(e){this.wave=e,this.id=0,this.type=0,this.x=30,this.y=225,this.spriteWidth=90,this.spriteHeight=90,this.maxFrame=10,this.frame=0,this.hp=5,this.maxHP=this.hp,this.posX=this.x,this.speed=.2,this.damage=1,this.spawnrate=200}update(e){this.x<=670&&(this.x+=this.speed,this.posX=this.x+55),this.id!==e&&(this.id=e)}preload(e){a.preloadImages(r,h,e)}draw(){i.drawImage(h[this.type],this.x,this.y),i.fillStyle="#f2e277",i.font="20px Syne Tactile, cursive",i.fillText(Math.floor(this.hp),this.x+45,this.y)}addEventListener(e,t){this.canvas.addEventListener(e,t)}currentVikings(){return o}currentInfo(){return[this.id,this.posX]}loseHP(e){this.hp-=e}currentImages(){return h}currentURLS(){return r}}}},t={};(new(function s(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,s),r.exports}(417))).animate()})();